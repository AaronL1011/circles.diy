{{define "dashboard"}}
{{template "base" .}}
{{end}}

{{define "main"}}
<div class="dashboard">
    <aside class="left-sidebar">
        <div class="quick-actions-vertical">
            <button class="action-btn-vertical primary"  >New Post</button>
            <button class="action-btn-vertical"  >Direct Message</button>
            <button class="action-btn-vertical"  >Create Gathering</button>
        </div>
        
        {{template "circles-sidebar" .}}
        
        <div class="sidebar-section">
            <h3>Stewardship</h3>
            <div class="impact-stats">
                {{range .Impact}}
                <div class="impact-item">
                    <span class="impact-label">{{.Label}}</span>
                    <span class="impact-value">{{.Value}}</span>
                </div>
                {{end}}
            </div>
            <button class="sidebar-action-btn"  >Manage Stewardship</button>
        </div>
    </aside>

    <div class="main-content" id="main-content">
        <!-- Mobile/Tablet Recent Ripples (compact horizontal) -->
        <section class="recent-ripples-mobile">
            <h3>
                {{template "ripples-icon" .}}
                Recent Ripples
            </h3>
            <div class="ripples-horizontal-scroll horitonzal-feed">
                {{range .Ripples}}
                <div class="ripple-card-compact">
                    <div class="ripple-user-compact">
                        <img class="ripple-avatar" src="{{.User.Avatar}}" alt="{{.User.Handle}}">
                    </div>
                    <div class="ripple-text-compact">
                        <div class="ripple-meta-compact">
                            <span>{{.User.Handle}}</span>
                            <span class="ripple-expires-compact">{{.ExpiresIn}}</span>
                        </div>
                        {{if .Content}}
                        <div class="ripple-content-compact">{{.Content}}</div>
                        {{end}}
                    </div>
                </div>
                {{end}}
            </div>
        </section>

        <section class="feed-section">
            <h2>Recent Activity</h2>
            <div class="activity-feed" id="activity-feed">
                {{range .Feed}}
                {{template "feed-item" .}}
                {{end}}
            </div>
            <div class="feed-more-container">
                <button class="feed-more-btn"   >
                    Load More Posts
                </button>
            </div>
        </section>

        <section class="discussions-section">
            <h2>Active Discussions</h2>
            <div class="discussion-list">
                {{range .Discussions}}
                <div class="discussion-item"  >
                    <div class="discussion-header">
                        <h3 class="discussion-title">{{.Title}}</h3>
                        <div class="discussion-meta">
                            <span class="discussion-circle">{{.Circle}}</span>
                            <span>{{.TimeAgo}}</span>
                        </div>
                    </div>
                    <p class="discussion-preview">{{.Preview}}</p>
                    <div class="discussion-actions">
                        <button class="discussion-action"  >Join Discussion</button>
                    </div>
                </div>
                {{end}}
            </div>
            <button class="see-all-btn"  >Browse All Discussions</button>
        </section>
    </div>

    <div class="right-sidebar">        
        <div class="sidebar-section recent-ripples-desktop">
            <h3>
                {{template "ripples-icon" .}}
                Recent Ripples
            </h3>
            <div class="ripples-compact">
                {{range .Ripples}}
                <div class="ripple-compact ripple-{{.ContentType}}"  >
                    <div class="ripple-user-compact">
                        <img class="ripple-avatar-small" src="{{.User.Avatar}}" alt="{{.User.Handle}}">
                        <span>{{.User.Handle}}</span>
                    </div>
                    
                    {{if eq .ContentType "image"}}
                        <div class="ripple-media-sidebar">
                            <img src="{{.Image.URL}}" alt="{{.Image.Alt}}" loading="lazy" />
                        </div>
                    {{else if eq .ContentType "video"}}
                        <div class="ripple-media-sidebar ripple-video">
                            <video preload="none">
                                <source src="{{.Video.URL}}" />
                            </video>
                            <div class="play-overlay-small">â–¶</div>
                        </div>
                    {{else if eq .ContentType "gallery"}}
                        <div class="ripple-gallery-sidebar">
                            {{range $index, $item := .Gallery}}
                            {{if lt $index 3}}
                            <img src="{{.URL}}" alt="{{.Alt}}" loading="lazy" />
                            {{end}}
                            {{end}}
                            {{if gt (len .Gallery) 3}}<div class="gallery-more-small">+{{sub (len .Gallery) 3}}</div>{{end}}
                        </div>
                    {{else if eq .ContentType "link"}}
                        <div class="ripple-link-sidebar">
                            <div class="link-preview-small">
                                {{if .Link.Image}}<img src="{{.Link.Image}}" alt="{{.Link.Title}}" />{{end}}
                                <div class="link-info-small">
                                    <div class="link-title-small">{{.Link.Title}}</div>
                                    <div class="link-domain-small">{{.Link.Domain}}</div>
                                </div>
                            </div>
                        </div>
                    {{end}}
                    
                    {{if .Content}}
                    <div class="ripple-content-compact">{{.Content}}</div>
                    {{end}}
                    
                    <div class="ripple-meta-compact">
                        <div class="ripple-expires-compact">{{.ExpiresIn}}</div>
                    </div>
                </div>
                {{end}}
            </div>
            <button class="sidebar-action-btn"  >New Ripple</button>
        </div>

        {{template "events-sidebar" .}}

        {{template "marketplace-sidebar" .}}
    </div>
</div>

<!-- Modal container for HTMX -->
<!-- <div id="modal" ></div> -->
{{end}}

{{define "scripts"}}

{{end}}