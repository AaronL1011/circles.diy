<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - circles.diy</title>
    <link rel="stylesheet" href="app.css">
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="brand">
                <h1>circles.diy</h1>
            </div>
            <nav class="main-nav">
                <button class="nav-item" data-section="dashboard" aria-current="page">Dashboard</button>
                <button class="nav-item" data-section="circles">Circles</button>
                <button class="nav-item" data-section="chat">Chat</button>
                <button class="nav-item" data-section="gatherings">Gatherings</button>
                <button class="nav-item" data-section="profile">Profile</button>
            </nav>
            <div class="header-actions">
                <div class="search-container">
                    <input type="search" placeholder="Search your circles..." class="global-search" aria-label="Global search">
                </div>
                <div class="theme-menu-container">
                    <button class="theme-menu" aria-label="Theme settings" aria-expanded="false">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1.5rem" height="1.5rem" fill="currentColor" viewBox="0 0 256 256"><path d="M200.77,53.89A103.27,103.27,0,0,0,128,24h-1.07A104,104,0,0,0,24,128c0,43,26.58,79.06,69.36,94.17A32,32,0,0,0,136,192a16,16,0,0,1,16-16h46.21a31.81,31.81,0,0,0,31.2-24.88,104.43,104.43,0,0,0,2.59-24A103.28,103.28,0,0,0,200.77,53.89Zm13,93.71A15.89,15.89,0,0,1,198.21,160H152a32,32,0,0,0-32,32,16,16,0,0,1-21.31,15.07C62.49,194.3,40,164,40,128a88,88,0,0,1,87.09-88h.9a88.35,88.35,0,0,1,88,87.25A88.86,88.86,0,0,1,213.81,147.6ZM140,76a12,12,0,1,1-12-12A12,12,0,0,1,140,76ZM96,100A12,12,0,1,1,84,88,12,12,0,0,1,96,100Zm0,56a12,12,0,1,1-12-12A12,12,0,0,1,96,156Zm88-56a12,12,0,1,1-12-12A12,12,0,0,1,184,100Z"></path></svg>
                    </button>
                    <div class="theme-dropdown" hidden>
                        <div class="theme-section">
                            <h4>Border Radius</h4>
                            <div class="radius-options">
                                <button class="radius-option" data-radius="0" title="Sharp corners">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><rect x="40" y="40" width="176" height="176" rx="0" stroke="currentColor" stroke-width="16" fill="none"></rect></svg>
                                </button>
                                <button class="radius-option" data-radius="8" title="Slightly rounded">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><rect x="40" y="40" width="176" height="176" rx="8" stroke="currentColor" stroke-width="16" fill="none"></rect></svg>
                                </button>
                                <button class="radius-option" data-radius="16" title="Moderately rounded">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><rect x="40" y="40" width="176" height="176" rx="16" stroke="currentColor" stroke-width="16" fill="none"></rect></svg>
                                </button>
                                <button class="radius-option" data-radius="24" title="Fully rounded">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><circle cx="128" cy="128" r="88" stroke="currentColor" stroke-width="16" fill="none"></circle></svg>
                                </button>
                            </div>
                        </div>
                        <div class="theme-section">
                            <h4>Color Theme</h4>
                            <div class="theme-options">
                                <button class="theme-option" data-theme="light" title="Light theme">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><circle cx="128" cy="128" r="60" fill="currentColor"></circle><path d="m128,36a8,8,0,0,1-8-8V8a8,8,0,0,1,16,0V28A8,8,0,0,1,128,36Z"></path><path d="m62.1,62.1a8,8,0,0,1-11.31,0L39.48,50.79a8,8,0,0,1,11.32-11.31L62.1,50.79A8,8,0,0,1,62.1,62.1Z"></path><path d="M36,128a8,8,0,0,1-8-8H8a8,8,0,0,1,0-16H28A8,8,0,0,1,36,128Z"></path><path d="m62.1,193.9a8,8,0,0,1-11.31,11.31L39.48,193.9a8,8,0,0,1,11.32-11.31l11.31,11.31A8,8,0,0,1,62.1,193.9Z"></path><path d="m128,220a8,8,0,0,1,8,8v20a8,8,0,0,1-16,0V228A8,8,0,0,1,128,220Z"></path><path d="m193.9,193.9a8,8,0,0,1,11.31-11.31l11.31,11.31a8,8,0,0,1-11.32,11.31L193.9,193.9A8,8,0,0,1,193.9,193.9Z"></path><path d="M220,128a8,8,0,0,1,8,8h20a8,8,0,0,1,0,16H228A8,8,0,0,1,220,128Z"></path><path d="m193.9,62.1a8,8,0,0,1,11.31-11.31l11.31,11.31a8,8,0,0,1-11.32,11.31L193.9,62.1A8,8,0,0,1,193.9,62.1Z"></path></svg>
                                    Light
                                </button>
                                <button class="theme-option" data-theme="dark" title="Dark theme">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><path d="M233.54,142.23a8,8,0,0,0-8-2A88,88,0,0,1,103.1,31.4,8,8,0,0,0,102,24a104,104,0,1,0,120,120A8,8,0,0,0,233.54,142.23Z"></path></svg>
                                    Dark
                                </button>
                                <button class="theme-option" data-theme="system" title="System theme">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><rect x="32" y="48" width="192" height="160" rx="16" fill="none" stroke="currentColor" stroke-width="16"></rect><line x1="160" y1="224" x2="96" y2="224" stroke="currentColor" stroke-width="16"></line><line x1="128" y1="192" x2="128" y2="224" stroke="currentColor" stroke-width="16"></line></svg>
                                    System
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="user-menu" aria-label="User menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.5rem" height="1.5rem" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM74.08,197.5a64,64,0,0,1,107.84,0,87.83,87.83,0,0,1-107.84,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.76,66.41a79.66,79.66,0,0,0-36.06-28.75,48,48,0,1,0-59.4,0,79.66,79.66,0,0,0-36.06,28.75,88,88,0,1,1,131.52,0Z"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="dashboard">
        <aside class="left-sidebar">
             <div class="quick-actions-vertical">
                    <button class="action-btn-vertical primary">New Post</button>
                    <button class="action-btn-vertical">Direct Message</button>
                    <button class="action-btn-vertical">Create Gathering</button>
                </div>
            <div class="sidebar-section">
                <h3>My Circles</h3>
                <div class="circle-list">
                    <div class="circle-item">
                        <div class="circle-thumbnail">
                            <img src="https://images.unsplash.com/photo-1504148455328-c376907d081c?w=24&h=24&fit=crop&crop=center" alt="Woodworking" />
                        </div>
                        <span class="circle-name">Woodworking</span>
                        <span class="circle-count">8 online</span>
                    </div>
                    <div class="circle-item">
                        <div class="circle-thumbnail">
                            <img src="https://cdn.britannica.com/15/152615-050-3CB2AEEA/Crop-circle-England.jpg" alt="The Crop Circle" />
                        </div>
                        <span class="circle-name">The Crop Circle</span>
                        <span class="circle-count">12 members</span>
                    </div>
                    <div class="circle-item">
                        <div class="circle-thumbnail">
                            <img src="https://images.unsplash.com/photo-1518611012118-696072aa579a?w=24&h=24&fit=crop&crop=center" alt="DIY Electronics" />
                        </div>
                        <span class="circle-name">DIY Electronics</span>
                        <span class="circle-count">24 members</span>
                    </div>
                </div>
                <button class="sidebar-action-btn">Browse Circles</button>
            </div>

            <div class="sidebar-section">
                <h3>Stewardship</h3>
                <div class="impact-stats">
                    <div class="impact-item">
                        <span class="impact-label">Contributions</span>
                        <span class="impact-value">47</span>
                    </div>
                    <div class="impact-item">
                        <span class="impact-label">Discussions</span>
                        <span class="impact-value">23</span>
                    </div>
                    <div class="impact-item">
                        <span class="impact-label">Circle Tithe</span>
                        <span class="impact-value">$5/month</span>
                    </div>
                </div>
                <button class="sidebar-action-btn">Manage Stewardship</button>
            </div>

            <div class="sidebar-section">
                <h3>Available Extensions</h3>
                <div class="extensions-list">
                    <div class="extension-item">
                        <span class="extension-name">Portfolio Showcase</span>
                        <button class="extension-toggle active" aria-label="Toggle extension">●</button>
                    </div>
                    <div class="extension-item">
                        <span class="extension-name">Event Planner</span>
                        <button class="extension-toggle active" aria-label="Toggle extension">●</button>
                    </div>
                    <div class="extension-item">
                        <span class="extension-name">Knowledge Base</span>
                        <button class="extension-toggle" aria-label="Toggle extension">○</button>
                    </div>
                </div>
                <button class="sidebar-action-btn">Browse More</button>
            </div>
        </aside>

        <section class="main-content">
            
            <div class="feed-section">
                <h2>Recent Activity</h2>
                <div class="activity-feed">
                    <article class="feed-item">
                        <div class="feed-header">
                            <div class="feed-user">
                                <div class="user-avatar">
                                    <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=128&h=128&fit=crop&crop=face" alt="@maia" />
                                </div>
                                <strong>@maia</strong>
                                <span class="feed-time">2m ago</span>
                            </div>
                            <div class="feed-circle">in Woodworking</div>
                        </div>
                        <div class="feed-content">
                            <div class="feed-image">
                                <img src="https://images.unsplash.com/photo-1707749522150-e3b1b5f3e079?w=900&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8b2FrJTIwdGFibGV8ZW58MHx8MHx8fDI%3D" alt="Oak coffee table project" />
                            </div>
                            <p>Just finished this oak coffee table! Happy to step out of my comfort-zone and share some joinery! This piece is available 💜💸</p>
                        </div>
                        <div class="feed-actions">
                            <button class="feed-action">Reply</button>
                            <button class="feed-action">Share</button>
                            <button class="feed-action">Buy Now</button>
                            <button class="feed-action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" fill="currentColor" viewBox="0 0 256 256"><path d="M128,96a32,32,0,1,0,32,32A32,32,0,0,0,128,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,144Zm0-64A32,32,0,1,0,96,48,32,32,0,0,0,128,80Zm0-48a16,16,0,1,1-16,16A16,16,0,0,1,128,32Zm0,144a32,32,0,1,0,32,32A32,32,0,0,0,128,176Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,224Z"></path></svg>
                            </button>
                        </div>
                    </article>
                    
                    <article class="feed-item">
                        <div class="feed-header">
                            <div class="feed-user">
                                <div class="user-avatar">
                                    <img src="https://unsplash.com/photos/_mscfMq3kKI/download?ixid=M3wxMjA3fDB8MXxzZWFyY2h8NXx8cHJvZmlsZSUyMHBpY3xlbnwwfHx8fDE3NTY2MzgyNTd8Mg&force=true&w=256&crop=face" alt="@heathtyler" />
                                </div>
                                <strong>@heathtyler</strong>
                                <span class="feed-time">15m ago</span>
                            </div>
                            <div class="feed-circle">in The Crop Circle</div>
                        </div>
                        <div class="feed-content">
                            <div class="feed-image">
                                <img src="https://images.unsplash.com/photo-1664463758574-e640a7a998d4?q=80&w=2831&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="BBQ gathering setup" />
                            </div>
                            <p>Warming up the barbeque and just got couple cases of the finest bread-water. Keen to see you all... remember 7PM dont be late!</p>
                        </div>
                        <div class="feed-actions">
                            <button class="feed-action">Reply</button>
                            <button class="feed-action">Share</button>
                            <button class="feed-action">RSVP</button>
                            <button class="feed-action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><path d="M128,96a32,32,0,1,0,32,32A32,32,0,0,0,128,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,144Zm0-64A32,32,0,1,0,96,48,32,32,0,0,0,128,80Zm0-48a16,16,0,1,1-16,16A16,16,0,0,1,128,32Zm0,144a32,32,0,1,0,32,32A32,32,0,0,0,128,176Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,224Z"></path></svg>
                            </button>
                        </div>
                    </article>
                    
                    <article class="feed-item">
                        <div class="feed-header">
                            <div class="feed-user">
                                <div class="user-avatar">
                                    <img src="https://unsplash.com/photos/3TLl_97HNJo/download?ixid=M3wxMjA3fDB8MXxzZWFyY2h8MTV8fHByb2ZpbGUlMjBwaWN8ZW58MHx8fHwxNzU2NjM4MjU3fDI&force=true&w=128&crop=face" alt="@sara_designs" />
                                </div>
                                <strong>@sara_pcb</strong>
                                <span class="feed-time">1h ago</span>
                            </div>
                            <div class="feed-circle">in DIY Electronics</div>
                        </div>
                        <div class="feed-content">
                            <div class="feed-image">
                                <img src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=400&h=250&fit=crop&crop=center" alt="Arduino tutorial setup" />
                            </div>
                            <p>New tutorial series starting: "Arduino for Beginners". First session covers basic circuits and programming fundamentals.</p>
                        </div>
                        <div class="feed-actions">
                            <button class="feed-action">Reply</button>
                            <button class="feed-action">Share</button>
                            <button class="feed-action">Join Workshop</button>
                            <button class="feed-action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><path d="M128,96a32,32,0,1,0,32,32A32,32,0,0,0,128,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,144Zm0-64A32,32,0,1,0,96,48,32,32,0,0,0,128,80Zm0-48a16,16,0,1,1-16,16A16,16,0,0,1,128,32Zm0,144a32,32,0,1,0,32,32A32,32,0,0,0,128,176Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,224Z"></path></svg>
                            </button>
                        </div>
                    </article>

                    <article class="feed-item">
                        <div class="feed-header">
                            <div class="feed-user">
                                <div class="user-avatar">
                                    <img src="https://media.tenor.com/y1mYLo66EuoAAAAM/zucky.gifs" alt="@juiceboxjess" />
                                </div>
                                <strong>@zucc</strong>
                                <span class="feed-time">1h ago</span>
                            </div>
                            <div class="feed-circle">in Communication Software</div>
                        </div>
                        <div class="feed-content">
                            <p>circles.diy has changed the game forever. <br><br>Fuck, I wish I'd thought of that.</p>
                        </div>
                        <div class="feed-actions">
                            <button class="feed-action">Reply</button>
                            <button class="feed-action">Share</button>
                            <button class="feed-action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><path d="M128,96a32,32,0,1,0,32,32A32,32,0,0,0,128,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,144Zm0-64A32,32,0,1,0,96,48,32,32,0,0,0,128,80Zm0-48a16,16,0,1,1-16,16A16,16,0,0,1,128,32Zm0,144a32,32,0,1,0,32,32A32,32,0,0,0,128,176Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,224Z"></path></svg>
                            </button>
                        </div>
                    </article>
                </div>
            </div>

            <div class="discussions-section">
                <h2>Active Discussions</h2>
                <div class="discussion-list">
                    <div class="discussion-item">
                        <div class="discussion-header">
                            <h3 class="discussion-title">Sustainable Materials: Where to Source?</h3>
                            <div class="discussion-meta">
                                <span class="discussion-circle">Woodworking</span>
                                <span class="discussion-stats">23 replies • 45m ago</span>
                            </div>
                        </div>
                        <p class="discussion-preview">Looking for suppliers of ethically sourced hardwoods. What are your go-to sources for...</p>
                        <div class="discussion-actions">
                            <button class="discussion-action">Join Discussion</button>
                        </div>
                    </div>
                    
                    <div class="discussion-item">
                        <div class="discussion-header">
                            <h3 class="discussion-title">Pricing Creative Work: Community Wisdom</h3>
                            <div class="discussion-meta">
                                <span class="discussion-circle">Local Artists</span>
                                <span class="discussion-stats">8 replies • 2h ago</span>
                            </div>
                        </div>
                        <p class="discussion-preview">How do you approach pricing custom commissions? Struggling to find the balance between...</p>
                        <div class="discussion-actions">
                            <button class="discussion-action">Join Discussion</button>
                        </div>
                    </div>
                </div>
                <button class="see-all-btn">Browse All Discussions</button>
            </div>


        </section>

        <aside class="right-sidebar">
            <div class="sidebar-section">
                <h3>Recent Ripples</h3>
                <div class="ripples-compact">
                    <div class="ripple-compact">
                        <div class="ripple-user-compact">@maia</div>
                        <div class="ripple-content-compact">Quick progress update on the oak table project...</div>
                        <div class="ripple-expires-compact">1h left</div>
                    </div>
                    <div class="ripple-compact">
                        <div class="ripple-user-compact">@craft_collective</div>
                        <div class="ripple-content-compact">Tip: pre-drill hardwood to avoid splitting</div>
                        <div class="ripple-expires-compact">18h left</div>
                    </div>
                </div>
                <button class="sidebar-action-btn">
                    <svg width="1.5rem" height="1.5rem" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="14" cy="14" r="5" stroke="currentColor" stroke-opacity="0.6" stroke-width="2"/>
                        <circle cx="14" cy="14" r="2" fill="currentColor"/>
                        <circle cx="14" cy="14" r="9" stroke="currentColor" stroke-opacity="0.3" stroke-width="2"/>
                        <circle cx="14" cy="14" r="13" stroke="currentColor" stroke-opacity="0.08" stroke-width="2"/>
                    </svg>

                    New Ripple
                </button>
            </div>

            <div class="sidebar-section">
                <h3>Upcoming Gatherings</h3>
                <div class="events-compact">
                    <div class="event-compact">
                        <div class="event-date-compact">
                            <span class="event-day-compact">31</span>
                            <span class="event-month-compact">Aug</span>
                        </div>
                        <div class="event-info-compact">
                            <div class="event-title-compact">Workshop: Intro to Drum & Bass Mixing</div>
                            <div class="event-time-compact">2:00 PM</div>
                        </div>
                    </div>
                    <div class="event-compact">
                        <div class="event-date-compact">
                            <span class="event-day-compact">02</span>
                            <span class="event-month-compact">Sep</span>
                        </div>
                        <div class="event-info-compact">
                            <div class="event-title-compact">Monthly Showcase</div>
                            <div class="event-time-compact">7:00 PM</div>
                        </div>
                    </div>
                </div>
                <button class="sidebar-action-btn">View Calendar</button>
            </div>

            <div class="sidebar-section">
                <h3>Circle Marketplace</h3>
                <div class="marketplace-items">
                    <div class="marketplace-item">
                        <div class="marketplace-image">
                            <img src="https://images.unsplash.com/photo-1504148455328-c376907d081c?w=120&h=80&fit=crop&crop=center" alt="Vintage Router Table" />
                        </div>
                        <div class="marketplace-header">
                            <div class="marketplace-title">Cordless Drill</div>
                            <div class="marketplace-price">$85</div>
                        </div>
                        <div class="marketplace-meta">
                            <span class="marketplace-location">Sydney, NSW</span>
                            <span class="marketplace-time">3h ago</span>
                        </div>
                        <div class="marketplace-actions">
                            <button class="marketplace-btn">View Item</button>
                        </div>
                    </div>
                    
                    <div class="marketplace-item">
                        <div class="marketplace-image">
                            <img src="https://unsplash.com/photos/ZSgWcW70cTs/download?ixid=M3wxMjA3fDB8MXxzZWFyY2h8NXx8Y2VyYW1pYyUyMHdoZWVsfGVufDB8fHx8MTc1NjU1NjAxNXwy&force=true&w=640" alt="Ceramic Wheel & Tools" />
                        </div>
                        <div class="marketplace-header">
                            <div class="marketplace-title">Ceramic Wheel & Tools</div>
                            <div class="marketplace-price">Trade</div>
                        </div>
                        <div class="marketplace-meta">
                            <span class="marketplace-location">Stanwell Park, NSW</span>
                            <span class="marketplace-time">1d ago</span>
                        </div>
                        <div class="marketplace-actions">
                            <button class="marketplace-btn">View Item</button>
                        </div>
                    </div>
                    
                    <div class="marketplace-item">
                        <div class="marketplace-image">
                            <img src="https://unsplash.com/photos/urjasxHT9Ck/download?ixid=M3wxMjA3fDB8MXxzZWFyY2h8OHx8bHVtYmVyfGVufDB8fHx8MTc1NjU1NjcwNnwy&force=true&w=640" alt="Oak Lumber Bundle" />
                        </div>
                        <div class="marketplace-header">
                            <div class="marketplace-title">Oak Lumber Bundle</div>
                            <div class="marketplace-price">$120</div>
                        </div>
                        <div class="marketplace-meta">
                            <span class="marketplace-location">Granville, NSW</span>
                            <span class="marketplace-time">2d ago</span>
                        </div>
                        <div class="marketplace-actions">
                            <button class="marketplace-btn">View Item</button>
                        </div>
                    </div>
                </div>
                <button class="sidebar-action-btn">Browse Marketplace</button>
            </div>
        </aside>
    </main>

    <script>
        // Theme Menu Implementation
        class ThemeManager {
            constructor() {
                this.themeButton = document.querySelector('.theme-menu');
                this.dropdown = document.querySelector('.theme-dropdown');
                this.radiusOptions = document.querySelectorAll('.radius-option');
                this.themeOptions = document.querySelectorAll('.theme-option');
                this.root = document.documentElement;
                
                this.init();
            }
            
            init() {
                // Load saved preferences
                this.loadPreferences();
                
                // Set up event listeners
                this.themeButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.toggleDropdown();
                });
                
                // Radius option handlers
                this.radiusOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        const radius = option.dataset.radius;
                        this.setRadius(radius);
                    });
                });
                
                // Theme option handlers
                this.themeOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        const theme = option.dataset.theme;
                        this.setTheme(theme);
                    });
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.theme-menu-container')) {
                        this.closeDropdown();
                    }
                });
                
                // Close on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !this.dropdown.hidden) {
                        this.closeDropdown();
                        this.themeButton.focus();
                    }
                });
            }
            
            toggleDropdown() {
                if (this.dropdown.hidden) {
                    this.openDropdown();
                } else {
                    this.closeDropdown();
                }
            }
            
            openDropdown() {
                this.dropdown.hidden = false;
                this.themeButton.setAttribute('aria-expanded', 'true');
            }
            
            closeDropdown() {
                this.dropdown.hidden = true;
                this.themeButton.setAttribute('aria-expanded', 'false');
            }
            
            setRadius(radius) {
                // Update CSS custom property
                this.root.style.setProperty('--container-radius', radius + 'px');
                
                // Update active state
                this.radiusOptions.forEach(option => {
                    option.classList.toggle('active', option.dataset.radius === radius);
                });
                
                // Save preference
                localStorage.setItem('theme-radius', radius);
            }
            
            setTheme(theme) {
                // Remove existing theme classes
                document.body.classList.remove('theme-light', 'theme-dark', 'theme-system');
                
                // Add new theme class
                document.body.classList.add(`theme-${theme}`);
                
                // Apply theme-specific styles
                if (theme === 'light') {
                    this.applyLightTheme();
                } else if (theme === 'dark') {
                    this.applyDarkTheme();
                } else {
                    this.applySystemTheme();
                }
                
                // Update active state
                this.themeOptions.forEach(option => {
                    option.classList.toggle('active', option.dataset.theme === theme);
                });
                
                // Save preference
                localStorage.setItem('theme-mode', theme);
            }
            
            applyLightTheme() {
                this.root.style.setProperty('--bg-primary', '#ffffff');
                this.root.style.setProperty('--bg-secondary', '#f5f5f5');
                this.root.style.setProperty('--bg-tertiary', '#f9f9f9');
                this.root.style.setProperty('--text-primary', '#000000');
                this.root.style.setProperty('--text-secondary', '#666666');
                this.root.style.setProperty('--text-tertiary', '#999999');
                this.root.style.setProperty('--border-primary', '#000000');
                this.root.style.setProperty('--border-secondary', '#cccccc');
                this.root.style.setProperty('--border-light', '#eeeeee');
                this.root.style.setProperty('--accent-primary', '#000000');
                this.root.style.setProperty('--accent-secondary', '#ffffff');
                this.root.style.setProperty('--hover-bg', '#f5f5f5');
                this.root.style.setProperty('--active-bg', '#000000');
                this.root.style.setProperty('--active-text', '#ffffff');
                this.root.style.setProperty('--shadow-color', 'rgba(0, 0, 0, 0.1)');
            }
            
            applyDarkTheme() {
                this.root.style.setProperty('--bg-primary', '#000000');
                this.root.style.setProperty('--bg-secondary', '#0a0a0a');
                this.root.style.setProperty('--bg-tertiary', '#111111');
                this.root.style.setProperty('--text-primary', '#ffffff');
                this.root.style.setProperty('--text-secondary', '#a3a3a3');
                this.root.style.setProperty('--text-tertiary', '#666666');
                this.root.style.setProperty('--border-primary', '#ffffff');
                this.root.style.setProperty('--border-secondary', '#333333');
                this.root.style.setProperty('--border-light', '#222222');
                this.root.style.setProperty('--accent-primary', '#ffffff');
                this.root.style.setProperty('--accent-secondary', '#000000');
                this.root.style.setProperty('--hover-bg', '#1a1a1a');
                this.root.style.setProperty('--active-bg', '#ffffff');
                this.root.style.setProperty('--active-text', '#000000');
                this.root.style.setProperty('--shadow-color', 'rgba(255, 255, 255, 0.1)');
            }
            
            applySystemTheme() {
                // Remove inline styles to let CSS media queries take over
                const properties = [
                    '--bg-primary', '--bg-secondary', '--bg-tertiary',
                    '--text-primary', '--text-secondary', '--text-tertiary',
                    '--border-primary', '--border-secondary', '--border-light',
                    '--accent-primary', '--accent-secondary',
                    '--hover-bg', '--active-bg', '--active-text', '--shadow-color'
                ];
                
                properties.forEach(prop => {
                    this.root.style.removeProperty(prop);
                });
            }
            
            loadPreferences() {
                // Load saved radius
                const savedRadius = localStorage.getItem('theme-radius') || '0';
                this.setRadius(savedRadius);
                
                // Load saved theme
                const savedTheme = localStorage.getItem('theme-mode') || 'system';
                this.setTheme(savedTheme);
            }
        }
        
        // Initialize theme manager when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new ThemeManager();
        });
    </script>
</body>
</html>